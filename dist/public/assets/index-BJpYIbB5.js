import{u as e,a1 as s,e as a,b0 as n,r as t,n as i,f as l,j as d,al as m,B as c,b1 as r,aU as o,aV as x,aW as p,aX as h,C as u,a as j,b as y,g as f,S as N,J as g,K as v,N as w,O as b,c as S,L as P,b2 as C,b3 as _,b4 as M,b5 as T,b6 as I,b7 as k,b8 as F,b9 as A,ba as D,I as E,ao as R,ap as z,aq as q,ar as L,as as $,at as K,bb as V,q as O,a$ as G,aj as B,p as U,M as W,bc as H,ai as Q,bd as J,be as X,bf as Y,a7 as Z,a8 as ee,a9 as se,aa as ae,ac as ne,l as te,W as ie,af as le,bg as de,aA as me,aB as ce,aC as re,aD as oe,aE as xe,aF as pe,aG as he,aH as ue,d as je,D as ye,T as fe,U as Ne,bh as ge}from"./index-C_9oFDzq.js";import{C as ve}from"./ComposedChart-BbkLmi4n.js";function we(){var we,be,Se,Pe;const{user:Ce}=e(),{t:_e}=s(),{toast:Me}=a(),Te=n(),[Ie,ke]=t.useState("dashboard"),[Fe,Ae]=t.useState(""),[De,Ee]=t.useState("all"),[Re,ze]=t.useState("all"),[qe,Le]=t.useState(1),[$e,Ke]=t.useState("12months"),[Ve,Oe]=t.useState(""),[Ge,Be]=t.useState(1),[Ue,We]=t.useState(1),[He,Qe]=t.useState(!1),[Je,Xe]=t.useState(null),[Ye,Ze]=t.useState(""),[es,ss]=t.useState(!1),[as,ns]=t.useState(!1),[ts,is]=t.useState(!1),[ls,ds]=t.useState(null),[ms,cs]=t.useState(null),[rs,os]=t.useState(!1),[xs,ps]=t.useState(null),[hs,us]=t.useState(""),[js,ys]=t.useState({status:"",paymentMethod:"",amount:"",notes:"",externalTransactionId:""}),{data:fs,isLoading:Ns}=i({queryKey:["admin","payments","metrics"],queryFn:async()=>{const e=await je("GET","/api/admin/payments/metrics");if(!e.ok)throw new Error("Failed to fetch payment metrics");return e.json()},enabled:!!(null==Ce?void 0:Ce.isSuperAdmin)}),{data:gs,isLoading:vs}=i({queryKey:["admin","payments","transactions",qe,De,Re],queryFn:async()=>{const e=new URLSearchParams;e.append("page",qe.toString()),e.append("limit","20"),De&&"all"!==De&&e.append("status",De),Re&&"all"!==Re&&e.append("paymentMethod",Re);const s=await je("GET",`/api/admin/payments/transactions?${e.toString()}`);if(!s.ok)throw new Error("Failed to fetch payment transactions");return s.json()},enabled:!!(null==Ce?void 0:Ce.isSuperAdmin)&&"transactions"===Ie}),{data:ws,isLoading:bs}=i({queryKey:["admin","payments","trends",$e],queryFn:async()=>{const e=await je("GET",`/api/admin/payments/trends?period=${$e}`);if(!e.ok)throw new Error("Failed to fetch payment trends");return e.json()},enabled:!!(null==Ce?void 0:Ce.isSuperAdmin)&&"dashboard"===Ie}),{data:Ss,isLoading:Ps}=i({queryKey:["admin","payments","pending",Ue],queryFn:async()=>{const e=new URLSearchParams;e.append("page",Ue.toString()),e.append("limit","20");const s=await je("GET",`/api/admin/payments/pending?${e.toString()}`);if(!s.ok)throw new Error("Failed to fetch pending payments");return s.json()},enabled:!!(null==Ce?void 0:Ce.isSuperAdmin)&&"pending"===Ie}),{data:Cs,isLoading:_s}=i({queryKey:["admin","payments","companies",Ge,Ve],queryFn:async()=>{const e=new URLSearchParams;e.append("page",Ge.toString()),e.append("limit","20"),Ve&&e.append("search",Ve);const s=await je("GET",`/api/admin/payments/companies?${e.toString()}`);if(!s.ok)throw new Error("Failed to fetch companies payment details");return s.json()},enabled:!!(null==Ce?void 0:Ce.isSuperAdmin)&&"companies"===Ie}),{data:Ms,isLoading:Ts}=i({queryKey:["admin","payments","method-performance"],queryFn:async()=>{const e=await je("GET","/api/admin/payments/method-performance");if(!e.ok)throw new Error("Failed to fetch payment method performance");return e.json()},enabled:!!(null==Ce?void 0:Ce.isSuperAdmin)&&"performance"===Ie}),{data:Is,isLoading:ks}=i({queryKey:["admin","companies",null==ms?void 0:ms.id,"transactions"],queryFn:async()=>{if(!(null==ms?void 0:ms.id))return[];const e=await je("GET",`/api/admin/companies/${ms.id}/payment-transactions`);if(!e.ok)throw new Error("Failed to fetch company transactions");return e.json()},enabled:!!(null==Ce?void 0:Ce.isSuperAdmin)&&!!(null==ms?void 0:ms.id)&&ts}),Fs=l({mutationFn:async({transactionId:e,notes:s})=>{const a=await je("PATCH",`/api/admin/payments/transactions/${e}/status`,{status:"completed",notes:s});if(!a.ok)throw new Error("Failed to mark payment as received");return a.json()},onSuccess:()=>{Te.invalidateQueries({queryKey:["admin","payments"]}),Me({title:_e("admin.payments.status_update.success","Payment status updated successfully"),description:"The payment has been marked as received."})},onError:e=>{Me({title:"Error",description:e.message,variant:"destructive"})}}),As=l({mutationFn:async({companyId:e,message:s})=>{const a=await je("POST",`/api/admin/payments/reminders/${e}`,{message:s,type:"email"});if(!a.ok)throw new Error("Failed to send reminder");return a.json()},onSuccess:()=>{Qe(!1),Ze(""),Xe(null),Me({title:_e("admin.payments.reminders.success","Reminder sent successfully"),description:"Payment reminder has been sent to the company."})},onError:e=>{Me({title:"Error",description:e.message,variant:"destructive"})}}),Ds=l({mutationFn:async({transactionId:e,updates:s})=>{const a=await je("PATCH",`/api/admin/payments/transactions/${e}`,s);if(!a.ok)throw new Error("Failed to update transaction");return a.json()},onSuccess:()=>{Te.invalidateQueries({queryKey:["admin","payments"]}),ss(!1),ds(null),Me({title:_e("admin.payments.edit.success","Transaction updated successfully"),description:"The payment transaction has been updated."})},onError:e=>{Me({title:"Error",description:e.message,variant:"destructive"})}}),Es=e=>{ds(e),ns(!0)},Rs=async e=>{try{await navigator.clipboard.writeText(e),Me({title:_e("admin.payments.copied","Copied to clipboard"),description:"The text has been copied to your clipboard."})}catch(s){Me({title:"Error",description:"Failed to copy to clipboard",variant:"destructive"})}};if(!(null==Ce?void 0:Ce.isSuperAdmin))return null;const zs=e=>d.jsx(B,{variant:{completed:"default",pending:"secondary",failed:"destructive",cancelled:"outline"}[e]||"outline",children:_e(`admin.payments.transactions.status.${e}`,e)}),qs=()=>Ns?d.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map(((e,s)=>d.jsxs(u,{children:[d.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsx(y,{className:"text-sm font-medium",children:d.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),d.jsx("div",{className:"h-4 w-4 bg-gray-200 rounded animate-pulse"})]}),d.jsxs(S,{children:[d.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse mb-2"}),d.jsx("div",{className:"h-3 bg-gray-200 rounded animate-pulse w-2/3"})]})]},s)))}):fs?d.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:[d.jsxs(u,{children:[d.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsx(y,{className:"text-sm font-medium",children:_e("admin.payments.metrics.total_revenue","Total Revenue")}),d.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})]}),d.jsxs(S,{children:[d.jsx("div",{className:"text-2xl font-bold",children:k(fs.totalRevenue)}),d.jsxs("p",{className:"text-xs text-muted-foreground",children:[_e("admin.payments.metrics.yearly_revenue","Yearly"),": ",k(fs.yearlyRevenue)]})]})]}),d.jsxs(u,{children:[d.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsx(y,{className:"text-sm font-medium",children:_e("admin.payments.metrics.monthly_revenue","Monthly Revenue")}),d.jsx(fe,{className:"h-4 w-4 text-muted-foreground"})]}),d.jsxs(S,{children:[d.jsx("div",{className:"text-2xl font-bold",children:k(fs.monthlyRevenue)}),d.jsxs("p",{className:"text-xs text-muted-foreground",children:[fs.monthlyGrowth>=0?"+":"",fs.monthlyGrowth.toFixed(1),"% ",_e("admin.payments.metrics.monthly_growth","from last month")]})]})]}),d.jsxs(u,{children:[d.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsx(y,{className:"text-sm font-medium",children:_e("admin.payments.metrics.active_subscriptions","Active Subscriptions")}),d.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"})]}),d.jsxs(S,{children:[d.jsx("div",{className:"text-2xl font-bold",children:fs.activeSubscriptions}),d.jsxs("p",{className:"text-xs text-muted-foreground",children:[_e("admin.payments.metrics.payment_success_rate","Success Rate"),": ",fs.paymentSuccessRate,"%"]})]})]}),d.jsxs(u,{children:[d.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[d.jsx(y,{className:"text-sm font-medium",children:_e("admin.payments.metrics.pending_payments","Pending Payments")}),d.jsx(ge,{className:"h-4 w-4 text-muted-foreground"})]}),d.jsxs(S,{children:[d.jsx("div",{className:"text-2xl font-bold",children:fs.pendingPayments}),d.jsx("p",{className:"text-xs text-muted-foreground",children:_e("admin.payments.pending.description","Require attention")})]})]})]}):null;return d.jsx(m,{children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"sm:text-2xl",children:_e("admin.payments.title","Payment Management")}),d.jsx("p",{className:"text-muted-foreground text-sm sm:text-base",children:_e("admin.payments.description","Comprehensive payment tracking and management dashboard")})]}),d.jsxs(c,{variant:"outline",className:"w-full sm:w-auto",children:[d.jsx(r,{className:"mr-2 h-4 w-4"}),d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.export.button","Export Data")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.export.short","Export")})]})]}),d.jsxs(o,{value:Ie,onValueChange:ke,className:"space-y-4",children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs(x,{className:"grid w-full grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-1",children:[d.jsxs(p,{value:"dashboard",className:"text-xs sm:text-sm",children:[d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.dashboard.title","Dashboard")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.dashboard.short","Dashboard")})]}),d.jsxs(p,{value:"transactions",className:"text-xs sm:text-sm",children:[d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.transactions.title","Transactions")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.transactions.short","Transactions")})]}),d.jsxs(p,{value:"pending",className:"text-xs sm:text-sm",children:[d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.pending.title","Pending")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.pending.short","Pending")})]}),d.jsxs(p,{value:"companies",className:"text-xs sm:text-sm",children:[d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.companies.title","Companies")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.companies.short","Companies")})]}),d.jsxs(p,{value:"performance",className:"text-xs sm:text-sm",children:[d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.performance.title","Performance")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.performance.short","Performance")})]})]})}),d.jsxs(h,{value:"dashboard",className:"space-y-4",children:[d.jsx(qs,{}),d.jsxs(u,{children:[d.jsxs(j,{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx(y,{className:"text-lg sm:text-xl",children:_e("admin.payments.trends.title","Payment Trends")}),d.jsx(f,{className:"text-sm",children:"Revenue and transaction trends over time"})]}),d.jsxs(N,{value:$e,onValueChange:Ke,children:[d.jsx(g,{className:"w-full sm:w-[180px]",children:d.jsx(v,{})}),d.jsxs(w,{children:[d.jsx(b,{value:"7days",children:_e("admin.payments.trends.period.7days","Last 7 Days")}),d.jsx(b,{value:"30days",children:_e("admin.payments.trends.period.30days","Last 30 Days")}),d.jsx(b,{value:"12months",children:_e("admin.payments.trends.period.12months","Last 12 Months")})]})]})]}),d.jsx(S,{children:bs?d.jsx("div",{className:"h-[300px] sm:h-[400px] flex items-center justify-center",children:d.jsx(P,{className:"h-8 w-8 animate-spin"})}):ws&&ws.length>0?d.jsx("div",{className:"h-[300px] sm:h-[400px]",children:d.jsx(C,{width:"100%",height:"100%",children:d.jsxs(ve,{data:ws,margin:{top:20,right:30,left:20,bottom:5},children:[d.jsx(_,{strokeDasharray:"3 3"}),d.jsx(M,{dataKey:"period",fontSize:12,tick:{fontSize:12}}),d.jsx(T,{yAxisId:"left",fontSize:12,tick:{fontSize:12}}),d.jsx(T,{yAxisId:"right",orientation:"right",fontSize:12,tick:{fontSize:12}}),d.jsx(I,{formatter:(e,s)=>["revenue"===s?k(Number(e)):e,"revenue"===s?_e("admin.payments.trends.revenue","Revenue"):_e("admin.payments.trends.transactions","Transactions")],contentStyle:{fontSize:"14px"}}),d.jsx(F,{wrapperStyle:{fontSize:"14px"}}),d.jsx(A,{yAxisId:"left",dataKey:"revenue",fill:"#8884d8",name:_e("admin.payments.trends.revenue","Revenue")}),d.jsx(D,{yAxisId:"right",type:"monotone",dataKey:"transactions",stroke:"#82ca9d",strokeWidth:2,name:_e("admin.payments.trends.transactions","Transactions")})]})})}):d.jsx("div",{className:"h-[300px] sm:h-[400px] flex items-center justify-center text-muted-foreground",children:"No trend data available"})})]})]}),d.jsx(h,{value:"transactions",className:"space-y-4",children:d.jsxs(u,{children:[d.jsxs(j,{children:[d.jsx(y,{children:_e("admin.payments.transactions.title","Payment Transactions")}),d.jsx(f,{children:"View and manage all payment transactions"})]}),d.jsxs(S,{children:[d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[d.jsx("div",{className:"flex-1",children:d.jsx(E,{placeholder:_e("admin.payments.companies.search_placeholder","Search companies..."),value:Fe,onChange:e=>Ae(e.target.value),className:"w-full sm:max-w-sm"})}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[d.jsxs(N,{value:De,onValueChange:Ee,children:[d.jsx(g,{className:"w-full sm:w-[180px]",children:d.jsx(v,{placeholder:_e("admin.payments.transactions.filter.all_statuses","All Statuses")})}),d.jsxs(w,{children:[d.jsx(b,{value:"all",children:_e("admin.payments.transactions.filter.all_statuses","All Statuses")}),d.jsx(b,{value:"completed",children:_e("admin.payments.transactions.status.completed","Completed")}),d.jsx(b,{value:"pending",children:_e("admin.payments.transactions.status.pending","Pending")}),d.jsx(b,{value:"failed",children:_e("admin.payments.transactions.status.failed","Failed")}),d.jsx(b,{value:"cancelled",children:_e("admin.payments.transactions.status.cancelled","Cancelled")})]})]}),d.jsxs(N,{value:Re,onValueChange:ze,children:[d.jsx(g,{className:"w-full sm:w-[180px]",children:d.jsx(v,{placeholder:_e("admin.payments.transactions.filter.all_methods","All Methods")})}),d.jsxs(w,{children:[d.jsx(b,{value:"all",children:_e("admin.payments.transactions.filter.all_methods","All Methods")}),d.jsx(b,{value:"stripe",children:"Stripe"}),d.jsx(b,{value:"paypal",children:"PayPal"}),d.jsx(b,{value:"mercadopago",children:"Mercado Pago"}),d.jsx(b,{value:"moyasar",children:"Moyasar"}),d.jsx(b,{value:"bank_transfer",children:"Bank Transfer"})]})]})]})]}),vs?d.jsx("div",{className:"flex items-center justify-center py-8",children:d.jsx(P,{className:"h-8 w-8 animate-spin"})}):d.jsx("div",{className:"overflow-x-auto",children:d.jsxs(R,{children:[d.jsx(z,{children:d.jsxs(q,{children:[d.jsx(L,{className:"min-w-[80px]",children:_e("admin.payments.transactions.table.id","ID")}),d.jsx(L,{className:"min-w-[150px]",children:_e("admin.payments.transactions.table.company","Company")}),d.jsx(L,{className:"min-w-[120px]",children:_e("admin.payments.transactions.table.plan","Plan")}),d.jsx(L,{className:"min-w-[100px]",children:_e("admin.payments.transactions.table.amount","Amount")}),d.jsx(L,{className:"min-w-[100px]",children:_e("admin.payments.transactions.table.method","Method")}),d.jsx(L,{className:"min-w-[100px]",children:_e("admin.payments.transactions.table.status","Status")}),d.jsx(L,{className:"min-w-[120px]",children:_e("admin.payments.transactions.table.date","Date")}),d.jsx(L,{className:"min-w-[200px]",children:_e("admin.payments.transactions.table.actions","Actions")})]})}),d.jsx($,{children:null==gs?void 0:gs.data.map((e=>d.jsxs(q,{children:[d.jsx(K,{className:"font-mono text-sm",children:e.id}),d.jsx(K,{className:"font-medium",children:e.companyName}),d.jsx(K,{children:e.planName}),d.jsx(K,{className:"font-medium",children:k(e.amount)}),d.jsx(K,{className:"capitalize",children:e.paymentMethod}),d.jsx(K,{children:zs(e.status)}),d.jsx(K,{className:"text-sm",children:V(e.createdAt)}),d.jsx(K,{children:d.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[d.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>Es(e),className:"justify-start sm:justify-center",children:[d.jsx(O,{className:"mr-1 h-3 w-3"}),d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.actions.view_details","View Details")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.actions.view","View")})]}),d.jsxs(c,{variant:"outline",size:"sm",onClick:()=>(e=>{var s;ds(e),ys({status:e.status,paymentMethod:e.paymentMethod,amount:e.amount.toString(),notes:e.notes||(null==(s=e.metadata)?void 0:s.notes)||"",externalTransactionId:e.externalTransactionId||""}),ss(!0)})(e),className:"justify-start sm:justify-center",children:[d.jsx(G,{className:"mr-1 h-3 w-3"}),d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.actions.edit_payment","Edit Payment")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.actions.edit","Edit")})]})]})})]},e.id)))})]})}),gs&&gs.totalPages>1&&d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-4",children:[d.jsxs("div",{className:"text-sm text-muted-foreground",children:[_e("admin.payments.pagination.showing","Showing")," ",20*(qe-1)+1," ",_e("admin.payments.pagination.to","to")," ",Math.min(20*qe,gs.total)," ",_e("admin.payments.pagination.of","of")," ",gs.total," ",_e("admin.payments.pagination.records","records")]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(c,{variant:"outline",size:"sm",onClick:()=>Le(Math.max(1,qe-1)),disabled:1===qe,className:"min-w-[80px]",children:_e("admin.payments.pagination.previous","Previous")}),d.jsx("div",{className:"flex items-center gap-1",children:d.jsxs("span",{className:"text-sm text-muted-foreground",children:[_e("admin.payments.pagination.page","Page")," ",qe," ",_e("admin.payments.pagination.of","of")," ",gs.totalPages]})}),d.jsx(c,{variant:"outline",size:"sm",onClick:()=>Le(Math.min(gs.totalPages,qe+1)),disabled:qe===gs.totalPages,className:"min-w-[80px]",children:_e("admin.payments.pagination.next","Next")})]})]})]})]})}),d.jsx(h,{value:"pending",className:"space-y-4",children:d.jsxs(u,{children:[d.jsxs(j,{children:[d.jsx(y,{children:_e("admin.payments.pending.title","Pending Payments")}),d.jsx(f,{children:_e("admin.payments.pending.description","Manage overdue and pending payments")})]}),d.jsx(S,{children:Ps?d.jsx("div",{className:"flex items-center justify-center py-8",children:d.jsx(P,{className:"h-8 w-8 animate-spin"})}):(null==Ss?void 0:Ss.data)&&Ss.data.length>0?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs(R,{children:[d.jsx(z,{children:d.jsxs(q,{children:[d.jsx(L,{className:"min-w-[150px]",children:_e("admin.payments.pending.table.company","Company")}),d.jsx(L,{className:"min-w-[120px]",children:_e("admin.payments.pending.table.plan","Plan")}),d.jsx(L,{className:"min-w-[100px]",children:_e("admin.payments.pending.table.amount","Amount")}),d.jsx(L,{className:"min-w-[120px]",children:_e("admin.payments.pending.table.days_overdue","Days Overdue")}),d.jsx(L,{className:"min-w-[100px]",children:_e("admin.payments.pending.table.method","Method")}),d.jsx(L,{className:"min-w-[250px]",children:_e("admin.payments.pending.table.actions","Actions")})]})}),d.jsx($,{children:Ss.data.map((e=>d.jsxs(q,{children:[d.jsx(K,{className:"font-medium",children:e.companyName}),d.jsx(K,{children:e.planName}),d.jsx(K,{className:"font-medium",children:k(e.amount)}),d.jsx(K,{children:d.jsxs(B,{variant:e.daysOverdue>30?"destructive":e.daysOverdue>7?"secondary":"outline",children:[e.daysOverdue," days"]})}),d.jsx(K,{className:"capitalize",children:e.paymentMethod}),d.jsx(K,{children:d.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[d.jsxs(c,{variant:"outline",size:"sm",onClick:()=>Fs.mutate({transactionId:e.id}),disabled:Fs.isPending,className:"justify-start sm:justify-center text-xs sm:text-sm",children:[d.jsx(U,{className:"mr-1 h-3 w-3"}),d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.actions.mark_received","Mark as Received")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.actions.mark","Mark")})]}),d.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{Xe(e.companyId),Qe(!0)},className:"justify-start sm:justify-center text-xs sm:text-sm",children:[d.jsx(W,{className:"mr-1 h-3 w-3"}),d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.actions.send_reminder","Send Reminder")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.actions.remind","Remind")})]})]})})]},e.id)))})]})}),Ss.totalPages>1&&d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-4",children:[d.jsxs("div",{className:"text-sm text-muted-foreground",children:[_e("admin.payments.pagination.showing","Showing")," ",20*(Ue-1)+1," ",_e("admin.payments.pagination.to","to")," ",Math.min(20*Ue,Ss.total)," ",_e("admin.payments.pagination.of","of")," ",Ss.total," ",_e("admin.payments.pagination.records","records")]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(c,{variant:"outline",size:"sm",onClick:()=>We(Math.max(1,Ue-1)),disabled:1===Ue,className:"min-w-[80px]",children:_e("admin.payments.pagination.previous","Previous")}),d.jsx("div",{className:"flex items-center gap-1",children:d.jsxs("span",{className:"text-sm text-muted-foreground",children:[_e("admin.payments.pagination.page","Page")," ",Ue," ",_e("admin.payments.pagination.of","of")," ",Ss.totalPages]})}),d.jsx(c,{variant:"outline",size:"sm",onClick:()=>We(Math.min(Ss.totalPages,Ue+1)),disabled:Ue===Ss.totalPages,className:"min-w-[80px]",children:_e("admin.payments.pagination.next","Next")})]})]})]}):d.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No pending payments found"})})]})}),d.jsx(h,{value:"companies",className:"space-y-4",children:d.jsxs(u,{children:[d.jsxs(j,{children:[d.jsx(y,{children:_e("admin.payments.companies.title","Company Payment Details")}),d.jsx(f,{children:"View payment information for all companies"})]}),d.jsxs(S,{children:[d.jsx("div",{className:"flex gap-4 mb-4",children:d.jsx("div",{className:"flex-1",children:d.jsx(E,{placeholder:_e("admin.payments.companies.search_placeholder","Search companies..."),value:Ve,onChange:e=>Oe(e.target.value),className:"w-full sm:max-w-sm"})})}),_s?d.jsx("div",{className:"flex items-center justify-center py-8",children:d.jsx(P,{className:"h-8 w-8 animate-spin"})}):Cs&&Cs.data.length>0?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"overflow-x-auto",children:d.jsxs(R,{children:[d.jsx(z,{children:d.jsxs(q,{children:[d.jsx(L,{className:"min-w-[180px]",children:_e("admin.payments.companies.table.company","Company")}),d.jsx(L,{className:"min-w-[120px]",children:_e("admin.payments.companies.table.plan","Plan")}),d.jsx(L,{className:"min-w-[100px]",children:_e("admin.payments.companies.table.status","Status")}),d.jsx(L,{className:"min-w-[140px]",children:_e("admin.payments.companies.table.last_payment","Last Payment")}),d.jsx(L,{className:"min-w-[130px]",children:_e("admin.payments.companies.table.next_renewal","Next Renewal")}),d.jsx(L,{className:"min-w-[130px]",children:_e("admin.payments.companies.table.payment_method","Payment Method")}),d.jsx(L,{className:"min-w-[100px]",children:_e("admin.payments.companies.table.total_paid","Total Paid")}),d.jsx(L,{className:"min-w-[120px]",children:_e("admin.payments.companies.table.actions","Actions")})]})}),d.jsx($,{children:Cs.data.map((e=>d.jsxs(q,{children:[d.jsx(K,{className:"font-medium",children:d.jsxs("div",{children:[d.jsx("div",{className:"font-semibold",children:e.name}),d.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: ",e.id]})]})}),d.jsx(K,{className:"font-medium",children:e.planName}),d.jsx(K,{children:d.jsx(B,{variant:"active"===e.subscriptionStatus?"default":"overdue"===e.subscriptionStatus?"destructive":"pending"===e.subscriptionStatus?"secondary":"outline",children:_e(`admin.payments.companies.status.${e.subscriptionStatus}`,e.subscriptionStatus)})}),d.jsx(K,{children:e.lastPaymentDate?d.jsxs("div",{children:[d.jsx("div",{className:"text-sm font-medium",children:V(e.lastPaymentDate)}),d.jsx("div",{className:"text-xs text-muted-foreground",children:k(e.lastPaymentAmount)})]}):d.jsx("span",{className:"text-muted-foreground text-sm",children:"No payments"})}),d.jsx(K,{children:e.subscriptionEndDate?d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(H,{className:"h-3 w-3"}),d.jsx("span",{className:"text-sm",children:V(e.subscriptionEndDate)})]}):d.jsx("span",{className:"text-muted-foreground",children:"-"})}),d.jsx(K,{children:e.lastPaymentMethod?d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx(Q,{className:"h-3 w-3"}),d.jsx("span",{className:"capitalize text-sm",children:e.lastPaymentMethod})]}):d.jsx("span",{className:"text-muted-foreground",children:"-"})}),d.jsx(K,{className:"font-medium",children:k(e.totalPaid)}),d.jsx(K,{children:d.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>(e=>{cs(e),is(!0)})(e),className:"text-xs sm:text-sm",children:[d.jsx(O,{className:"mr-1 h-3 w-3"}),d.jsx("span",{className:"hidden sm:inline",children:_e("admin.payments.actions.view_details","View Details")}),d.jsx("span",{className:"sm:hidden",children:_e("admin.payments.actions.view","View")})]})})]},e.id)))})]})}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-4",children:[d.jsxs("div",{className:"text-sm text-muted-foreground",children:[_e("admin.payments.pagination.showing","Showing")," ",20*(Ge-1)+1," ",_e("admin.payments.pagination.to","to")," ",Math.min(20*Ge,Cs.total)," ",_e("admin.payments.pagination.of","of")," ",Cs.total," ",_e("admin.payments.pagination.records","records")]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(c,{variant:"outline",size:"sm",onClick:()=>Be(Math.max(1,Ge-1)),disabled:1===Ge,className:"min-w-[80px]",children:_e("admin.payments.pagination.previous","Previous")}),d.jsx("div",{className:"flex items-center gap-1",children:d.jsxs("span",{className:"text-sm text-muted-foreground",children:[_e("admin.payments.pagination.page","Page")," ",Ge," ",_e("admin.payments.pagination.of","of")," ",Cs.totalPages]})}),d.jsx(c,{variant:"outline",size:"sm",onClick:()=>Be(Ge+1),disabled:Ge>=Cs.totalPages,className:"min-w-[80px]",children:_e("admin.payments.pagination.next","Next")})]})]})]}):d.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No companies found"})]})]})}),d.jsx(h,{value:"performance",className:"space-y-4",children:d.jsxs(u,{children:[d.jsxs(j,{children:[d.jsx(y,{children:_e("admin.payments.performance.title","Payment Method Performance")}),d.jsx(f,{children:"Analyze performance across different payment methods"})]}),d.jsx(S,{children:Ts?d.jsx("div",{className:"flex items-center justify-center py-8",children:d.jsx(P,{className:"h-8 w-8 animate-spin"})}):Ms&&Ms.length>0?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 mb-6",children:Ms.map((e=>d.jsxs(u,{children:[d.jsx(j,{className:"pb-2",children:d.jsx(y,{className:"text-sm font-medium capitalize",children:e.paymentMethod})}),d.jsxs(S,{children:[d.jsxs("div",{className:"text-xl sm:text-2xl font-bold",children:[e.successRate.toFixed(1),"%"]}),d.jsx("p",{className:"text-xs text-muted-foreground",children:"Success Rate"}),d.jsxs("div",{className:"mt-2 text-xs sm:text-sm",children:[d.jsx("div",{className:"font-medium",children:k(e.totalRevenue)}),d.jsxs("div",{className:"text-muted-foreground",children:[e.totalTransactions," transactions"]})]})]})]},e.paymentMethod)))}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs(R,{children:[d.jsx(z,{children:d.jsxs(q,{children:[d.jsx(L,{className:"min-w-[140px]",children:_e("admin.payments.performance.table.method","Payment Method")}),d.jsx(L,{className:"min-w-[140px]",children:_e("admin.payments.performance.table.transactions","Total Transactions")}),d.jsx(L,{className:"min-w-[160px]",children:_e("admin.payments.performance.table.success_rate","Success Rate")}),d.jsx(L,{className:"min-w-[120px]",children:_e("admin.payments.performance.table.revenue","Total Revenue")}),d.jsx(L,{className:"min-w-[120px]",children:_e("admin.payments.performance.table.avg_amount","Average Amount")})]})}),d.jsx($,{children:Ms.map((e=>d.jsxs(q,{children:[d.jsx(K,{className:"font-medium capitalize",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Q,{className:"h-4 w-4"}),d.jsx("span",{className:"text-sm sm:text-base",children:e.paymentMethod})]})}),d.jsx(K,{children:d.jsxs("div",{children:[d.jsx("div",{className:"font-medium text-sm sm:text-base",children:e.totalTransactions}),d.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground",children:[e.successfulTransactions," successful"]})]})}),d.jsx(K,{children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-12 sm:w-16 bg-gray-200 rounded-full h-2",children:d.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${e.successRate}%`}})}),d.jsxs("span",{className:"font-medium text-sm sm:text-base",children:[e.successRate.toFixed(1),"%"]})]})}),d.jsx(K,{className:"font-medium text-sm sm:text-base",children:k(e.totalRevenue)}),d.jsx(K,{className:"text-sm sm:text-base",children:k(e.averageAmount)})]},e.paymentMethod)))})]})}),d.jsxs("div",{className:"mt-6",children:[d.jsx("h3",{className:"text-base sm:text-lg font-medium mb-4",children:"Revenue Distribution"}),d.jsx("div",{className:"h-[250px] sm:h-[300px]",children:d.jsx(C,{width:"100%",height:"100%",children:d.jsxs(J,{children:[d.jsx(X,{data:Ms,dataKey:"totalRevenue",nameKey:"paymentMethod",cx:"50%",cy:"50%",outerRadius:"60%",fill:"#8884d8",label:({paymentMethod:e,percent:s})=>window.innerWidth>=640?`${e}: ${(100*s).toFixed(0)}%`:`${(100*s).toFixed(0)}%`,labelLine:!1,children:Ms.map(((e,s)=>d.jsx(Y,{fill:["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"][s%5]},`cell-${s}`)))}),d.jsx(I,{formatter:e=>k(Number(e))})]})})})]})]}):d.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No performance data available"})})]})})]}),d.jsx(Z,{open:es,onOpenChange:ss,children:d.jsxs(ee,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsxs(se,{children:[d.jsx(ae,{className:"text-lg sm:text-xl",children:_e("admin.payments.edit.title","Edit Payment Transaction")}),d.jsx(ne,{className:"text-sm",children:"Modify payment transaction details. Be careful when changing completed payments."})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx(te,{htmlFor:"edit-status",children:_e("admin.payments.edit.status","Status")}),d.jsxs(N,{value:js.status,onValueChange:e=>ys((s=>({...s,status:e}))),children:[d.jsx(g,{children:d.jsx(v,{})}),d.jsxs(w,{children:[d.jsx(b,{value:"pending",children:_e("admin.payments.status.pending","Pending")}),d.jsx(b,{value:"completed",children:_e("admin.payments.status.completed","Completed")}),d.jsx(b,{value:"failed",children:_e("admin.payments.status.failed","Failed")}),d.jsx(b,{value:"cancelled",children:_e("admin.payments.status.cancelled","Cancelled")})]})]})]}),d.jsxs("div",{children:[d.jsx(te,{htmlFor:"edit-method",children:_e("admin.payments.edit.payment_method","Payment Method")}),d.jsxs(N,{value:js.paymentMethod,onValueChange:e=>ys((s=>({...s,paymentMethod:e}))),children:[d.jsx(g,{children:d.jsx(v,{})}),d.jsxs(w,{children:[d.jsx(b,{value:"stripe",children:"Stripe"}),d.jsx(b,{value:"paypal",children:"PayPal"}),d.jsx(b,{value:"mercado_pago",children:"Mercado Pago"}),d.jsx(b,{value:"moyasar",children:"Moyasar"}),d.jsx(b,{value:"bank_transfer",children:"Bank Transfer"})]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx(te,{htmlFor:"edit-amount",children:_e("admin.payments.edit.amount","Amount")}),d.jsx(E,{id:"edit-amount",type:"number",step:"0.01",value:js.amount,onChange:e=>ys((s=>({...s,amount:e.target.value}))),placeholder:"0.00"})]}),d.jsxs("div",{children:[d.jsx(te,{htmlFor:"edit-external-id",children:_e("admin.payments.edit.external_id","External Transaction ID")}),d.jsx(E,{id:"edit-external-id",value:js.externalTransactionId,onChange:e=>ys((s=>({...s,externalTransactionId:e.target.value}))),placeholder:"External reference ID"})]})]}),d.jsxs("div",{children:[d.jsx(te,{htmlFor:"edit-notes",children:_e("admin.payments.edit.notes","Notes")}),d.jsx(ie,{id:"edit-notes",value:js.notes,onChange:e=>ys((s=>({...s,notes:e.target.value}))),placeholder:_e("admin.payments.edit.notes_placeholder","Add notes about this transaction..."),rows:3})]})]}),d.jsxs(le,{className:"flex flex-col sm:flex-row gap-2",children:[d.jsx(c,{variant:"outline",onClick:()=>ss(!1),className:"w-full sm:w-auto",children:"Cancel"}),d.jsxs(c,{onClick:()=>{if(!ls)return;const e={status:js.status,paymentMethod:js.paymentMethod,amount:parseFloat(js.amount),notes:js.notes,externalTransactionId:js.externalTransactionId};"completed"===ls.status&&["pending","failed","cancelled"].includes(js.status)?(us(_e("admin.payments.edit.confirm_status_change","Are you sure you want to change this completed payment back to {{status}}? This action may affect billing and should only be done to correct errors.",{status:js.status})),ps((()=>()=>{Ds.mutate({transactionId:ls.id,updates:e}),os(!1)})),os(!0)):Ds.mutate({transactionId:ls.id,updates:e})},disabled:Ds.isPending||!js.amount||!js.status,className:"w-full sm:w-auto",children:[Ds.isPending?d.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}):d.jsx(G,{className:"mr-2 h-4 w-4"}),_e("admin.payments.edit.save_button","Save Changes")]})]})]})}),d.jsx(Z,{open:He,onOpenChange:Qe,children:d.jsxs(ee,{children:[d.jsxs(se,{children:[d.jsx(ae,{children:_e("admin.payments.reminders.title","Send Payment Reminder")}),d.jsx(ne,{children:"Send a payment reminder to the selected company."})]}),d.jsx("div",{className:"space-y-4",children:d.jsx(ie,{placeholder:_e("admin.payments.reminders.message_placeholder","Enter reminder message..."),value:Ye,onChange:e=>Ze(e.target.value),rows:4})}),d.jsxs(le,{children:[d.jsx(c,{variant:"outline",onClick:()=>Qe(!1),children:"Cancel"}),d.jsxs(c,{onClick:()=>{Je&&Ye.trim()&&As.mutate({companyId:Je,message:Ye.trim()})},disabled:!Ye.trim()||As.isPending,children:[As.isPending?d.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}):d.jsx(W,{className:"mr-2 h-4 w-4"}),_e("admin.payments.reminders.send_button","Send Reminder")]})]})]})}),d.jsx(Z,{open:as,onOpenChange:ns,children:d.jsxs(ee,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[d.jsxs(se,{children:[d.jsx(ae,{className:"text-lg sm:text-xl",children:_e("admin.payments.view.title","Payment Transaction Details")}),d.jsxs(ne,{className:"text-sm",children:["Complete information for transaction #",null==ls?void 0:ls.id]})]}),ls&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs(u,{children:[d.jsx(j,{className:"pb-3",children:d.jsx(y,{className:"text-lg",children:_e("admin.payments.view.basic_info","Basic Information")})}),d.jsxs(S,{className:"space-y-3",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.transaction_id","Transaction ID"),":"]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-mono",children:ls.id}),d.jsx(c,{variant:"ghost",size:"sm",onClick:()=>Rs(ls.id.toString()),children:d.jsx(de,{className:"h-3 w-3"})})]})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.status","Status"),":"]}),d.jsx("span",{children:zs(ls.status)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.amount","Amount"),":"]}),d.jsx("span",{className:"font-semibold",children:k(ls.amount)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.payment_method","Payment Method"),":"]}),d.jsx("span",{className:"capitalize",children:ls.paymentMethod})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.created_at","Created"),":"]}),d.jsx("span",{children:V(ls.createdAt)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.updated_at","Updated"),":"]}),d.jsx("span",{children:V(ls.updatedAt)})]})]})]}),d.jsxs(u,{children:[d.jsx(j,{className:"pb-3",children:d.jsx(y,{className:"text-lg",children:_e("admin.payments.view.company_info","Company Information")})}),d.jsxs(S,{className:"space-y-3",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.company_id","Company ID"),":"]}),d.jsx("span",{className:"font-mono",children:ls.companyId})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.company_name","Company Name"),":"]}),d.jsx("span",{className:"font-medium",children:ls.companyName})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.plan_id","Plan ID"),":"]}),d.jsx("span",{className:"font-mono",children:ls.planId})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-muted-foreground",children:[_e("admin.payments.view.plan_name","Plan Name"),":"]}),d.jsx("span",{className:"font-medium",children:ls.planName})]})]})]})]}),(ls.paymentIntentId||ls.externalTransactionId||ls.metadata)&&d.jsxs(u,{children:[d.jsx(j,{className:"pb-3",children:d.jsx(y,{className:"text-lg",children:_e("admin.payments.view.payment_details","Payment Method Details")})}),d.jsxs(S,{className:"space-y-3",children:[ls.paymentIntentId&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-muted-foreground",children:"stripe"===ls.paymentMethod?"Stripe Payment Intent ID:":"Payment Intent ID:"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-mono text-sm",children:ls.paymentIntentId}),d.jsx(c,{variant:"ghost",size:"sm",onClick:()=>Rs(ls.paymentIntentId),children:d.jsx(de,{className:"h-3 w-3"})})]})]}),ls.externalTransactionId&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-muted-foreground",children:"External Transaction ID:"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-mono text-sm",children:ls.externalTransactionId}),d.jsx(c,{variant:"ghost",size:"sm",onClick:()=>Rs(ls.externalTransactionId),children:d.jsx(de,{className:"h-3 w-3"})})]})]}),(null==(we=ls.metadata)?void 0:we.reference)&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-muted-foreground",children:"Reference:"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-mono text-sm",children:ls.metadata.reference}),d.jsx(c,{variant:"ghost",size:"sm",onClick:()=>Rs(ls.metadata.reference),children:d.jsx(de,{className:"h-3 w-3"})})]})]}),(null==(be=ls.metadata)?void 0:be.paypalTransactionId)&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-muted-foreground",children:"PayPal Transaction ID:"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"font-mono text-sm",children:ls.metadata.paypalTransactionId}),d.jsx(c,{variant:"ghost",size:"sm",onClick:()=>Rs(ls.metadata.paypalTransactionId),children:d.jsx(de,{className:"h-3 w-3"})})]})]})]})]}),(ls.notes||(null==(Se=ls.metadata)?void 0:Se.notes))&&d.jsxs(u,{children:[d.jsx(j,{className:"pb-3",children:d.jsx(y,{className:"text-lg",children:_e("admin.payments.view.notes","Notes")})}),d.jsx(S,{children:d.jsx("p",{className:"text-sm whitespace-pre-wrap",children:ls.notes||(null==(Pe=ls.metadata)?void 0:Pe.notes)})})]})]}),d.jsx(le,{children:d.jsx(c,{variant:"outline",onClick:()=>ns(!1),children:"Close"})})]})}),d.jsx(me,{open:rs,onOpenChange:os,children:d.jsxs(ce,{children:[d.jsxs(re,{children:[d.jsx(oe,{children:_e("admin.payments.confirm.title","Confirm Action")}),d.jsx(xe,{children:hs})]}),d.jsxs(pe,{children:[d.jsx(he,{onClick:()=>os(!1),children:"Cancel"}),d.jsx(ue,{onClick:()=>xs&&xs(),children:"Continue"})]})]})}),d.jsx(Z,{open:ts,onOpenChange:is,children:d.jsxs(ee,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[d.jsxs(se,{children:[d.jsx(ae,{className:"text-xl font-semibold",children:_e("admin.payments.company_view.title","Company Payment Details")}),d.jsx(ne,{children:_e("admin.payments.company_view.description","Comprehensive payment information for this company")})]}),ms&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs(u,{children:[d.jsx(j,{className:"pb-3",children:d.jsx(y,{className:"text-lg",children:_e("admin.payments.company_view.company_info","Company Information")})}),d.jsx(S,{className:"space-y-3",children:d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Company Name:"}),d.jsx("p",{className:"text-sm font-semibold",children:ms.name})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Company ID:"}),d.jsx("p",{className:"text-sm font-mono",children:ms.id})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Member Since:"}),d.jsx("p",{className:"text-sm",children:V(ms.createdAt)})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Current Plan:"}),d.jsx("p",{className:"text-sm font-semibold",children:ms.planName})]})]})})]}),d.jsxs(u,{children:[d.jsx(j,{className:"pb-3",children:d.jsx(y,{className:"text-lg",children:_e("admin.payments.company_view.subscription","Subscription Details")})}),d.jsx(S,{className:"space-y-3",children:d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Status:"}),d.jsx("div",{className:"mt-1",children:d.jsx(B,{variant:"active"===ms.subscriptionStatus?"default":"pending"===ms.subscriptionStatus?"secondary":"overdue"===ms.subscriptionStatus?"destructive":"outline",children:ms.subscriptionStatus})})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Next Renewal:"}),d.jsx("p",{className:"text-sm",children:ms.subscriptionEndDate?V(ms.subscriptionEndDate):"No renewal date set"})]})]})})]}),d.jsxs(u,{children:[d.jsx(j,{className:"pb-3",children:d.jsx(y,{className:"text-lg",children:_e("admin.payments.company_view.payment_summary","Payment Summary")})}),d.jsx(S,{className:"space-y-3",children:d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Total Paid:"}),d.jsx("p",{className:"text-lg font-bold text-green-600",children:k(ms.totalPaid)})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Last Payment:"}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"text-sm font-semibold",children:ms.lastPaymentAmount>0?k(ms.lastPaymentAmount):"No payments yet"}),ms.lastPaymentDate&&d.jsx("p",{className:"text-xs text-muted-foreground",children:V(ms.lastPaymentDate)})]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Payment Method:"}),d.jsx("p",{className:"text-sm",children:ms.lastPaymentMethod?ms.lastPaymentMethod.replace("_"," ").toUpperCase():"No payment method on file"})]})]})})]}),d.jsxs(u,{children:[d.jsx(j,{className:"pb-3",children:d.jsx(y,{className:"text-lg",children:_e("admin.payments.company_view.transactions","Payment Transactions")})}),d.jsx(S,{children:ks?d.jsx("div",{className:"flex items-center justify-center py-4",children:d.jsx(P,{className:"h-6 w-6 animate-spin"})}):Is&&Is.length>0?d.jsxs("div",{className:"space-y-3",children:[Is.slice(0,5).map((e=>d.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(B,{variant:"completed"===e.status?"default":"pending"===e.status?"secondary":"failed"===e.status?"destructive":"outline",children:e.status}),d.jsx("span",{className:"text-sm font-medium",children:k(e.amount)}),d.jsx("span",{className:"text-xs text-muted-foreground",children:e.paymentMethod.replace("_"," ").toUpperCase()})]}),d.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:V(e.createdAt)})]}),d.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{is(!1),Es(e)},children:d.jsx(O,{className:"h-3 w-3"})})]},e.id))),Is.length>5&&d.jsxs("p",{className:"text-xs text-muted-foreground text-center pt-2",children:["Showing 5 of ",Is.length," transactions"]})]}):d.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No payment transactions found for this company."})})]})]}),d.jsx(le,{children:d.jsx(c,{variant:"outline",onClick:()=>is(!1),children:_e("common.close","Close")})})]})})]})})}export{we as default};
