import{q as e,u as s,e as a,r as t,h as l,j as i,L as r,K as n,aq as c,ar as d,as as o,at as x,au as m,B as h,C as u,a as j,b as f,F as y,c as v,bA as g,M as p,bs as N,l as w,bB as b,d as C}from"./index-Du4k3PvU.js";const A=e("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),L=e("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);function k(){var e,k,M,S;const{user:T,isLoading:z}=s(),[D,E]=a(),[F,$]=t.useState("30days");t.useEffect((()=>{z||!T||T.isSuperAdmin||E("/")}),[T,z,E]);const{data:U,isLoading:q,error:G}=l({queryKey:["/api/admin/analytics",F],queryFn:async()=>{try{console.log(`Fetching analytics data with timeRange=${F}`);const e=await C("GET",`/api/admin/analytics?timeRange=${F}`);if(!e.ok)throw console.error(`Analytics API error: ${e.status} ${e.statusText}`),new Error(`Failed to fetch analytics data: ${e.status} ${e.statusText}`);const s=await e.json();return console.log("Analytics data received:",s),s}catch(e){throw console.error("Error fetching analytics data:",e),e}},enabled:!!(null==T?void 0:T.isSuperAdmin),retry:2});return z?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(r,{className:"h-8 w-8 animate-spin text-primary"})}):(null==T?void 0:T.isSuperAdmin)?i.jsx(n,{children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h1",{className:"text-2xl",children:"Analytics Dashboard"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-muted-foreground",children:"Time Range:"}),i.jsxs(c,{value:F,onValueChange:$,children:[i.jsx(d,{className:"w-[180px]",children:i.jsx(o,{placeholder:"Select time range"})}),i.jsxs(x,{children:[i.jsx(m,{value:"7days",children:"Last 7 Days"}),i.jsx(m,{value:"30days",children:"Last 30 Days"}),i.jsx(m,{value:"90days",children:"Last 90 Days"}),i.jsx(m,{value:"year",children:"Last Year"}),i.jsx(m,{value:"all",children:"All Time"})]})]})]})]}),q?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(r,{className:"h-8 w-8 animate-spin text-primary"})}):G?i.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),i.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),i.jsx("h3",{className:"text-xl font-bold mb-2",children:"Error Loading Analytics"}),i.jsx("p",{className:"text-gray-600 mb-4 text-center max-w-md",children:G instanceof Error?G.message:"Failed to load analytics data"}),i.jsx(h,{onClick:()=>window.location.reload(),children:"Retry"})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[i.jsxs(u,{children:[i.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(f,{className:"text-sm font-medium",children:"Total Users"}),i.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(v,{children:[i.jsx("div",{className:"text-2xl",children:(null==U?void 0:U.totalUsers)||0}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",(null==(k=null==(e=null==U?void 0:U.userGrowth)?void 0:e[U.userGrowth.length-1])?void 0:k.count)||0," in the last period"]})]})]}),i.jsxs(u,{children:[i.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(f,{className:"text-sm font-medium",children:"Companies"}),i.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(v,{children:[i.jsx("div",{className:"text-2xl",children:(null==U?void 0:U.totalCompanies)||0}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[(null==U?void 0:U.activeCompanies)||0," active companies"]})]})]}),i.jsxs(u,{children:[i.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(f,{className:"text-sm font-medium",children:"Messages"}),i.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(v,{children:[i.jsx("div",{className:"text-2xl",children:(null==(M=null==U?void 0:U.totalMessages)?void 0:M.toLocaleString())||0}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:["Across ",(null==U?void 0:U.totalConversations)||0," conversations"]})]})]}),i.jsxs(u,{children:[i.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(f,{className:"text-sm font-medium",children:"Contacts"}),i.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(v,{children:[i.jsx("div",{className:"text-2xl",children:(null==(S=null==U?void 0:U.totalContacts)?void 0:S.toLocaleString())||0}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"In contact database"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs(u,{children:[i.jsxs(j,{children:[i.jsx(f,{children:"User Growth"}),i.jsx(w,{children:"New user registrations over time"})]}),i.jsx(v,{className:"h-80",children:i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx(A,{className:"h-16 w-16 text-muted-foreground"}),i.jsx("p",{className:"ml-4 text-muted-foreground",children:"User growth chart visualization"})]})})]}),i.jsxs(u,{children:[i.jsxs(j,{children:[i.jsx(f,{children:"Messages by Channel"}),i.jsx(w,{children:"Distribution of messages across channels"})]}),i.jsx(v,{className:"h-80",children:i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx(L,{className:"h-16 w-16 text-muted-foreground"}),i.jsx("p",{className:"ml-4 text-muted-foreground",children:"Channel distribution chart visualization"})]})})]}),i.jsxs(u,{children:[i.jsxs(j,{children:[i.jsx(f,{children:"Conversations by Company"}),i.jsx(w,{children:"Top companies by conversation volume"})]}),i.jsx(v,{className:"h-80",children:i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx(b,{className:"h-16 w-16 text-muted-foreground"}),i.jsx("p",{className:"ml-4 text-muted-foreground",children:"Company conversation chart visualization"})]})})]}),i.jsxs(u,{children:[i.jsxs(j,{children:[i.jsx(f,{children:"Active Users"}),i.jsx(w,{children:"Daily active users over time"})]}),i.jsx(v,{className:"h-80",children:i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx(A,{className:"h-16 w-16 text-muted-foreground"}),i.jsx("p",{className:"ml-4 text-muted-foreground",children:"Active users chart visualization"})]})})]})]})]})]})}):null}export{k as default};
