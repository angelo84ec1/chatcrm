import{a5 as e,u as s,m as a,r as t,n as l,j as i,L as n,al as r,S as c,J as d,K as x,N as o,O as m,B as h,C as j,a as u,b as f,U as v,c as y,H as p,ag as N,bc as g,g as w,bi as b,d as C}from"./index-C_9oFDzq.js";const L=e("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),k=e("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);function A(){var e,A,S,z;const{user:D,isLoading:M}=s(),[T,U]=a(),[E,F]=t.useState("30days");t.useEffect((()=>{M||!D||D.isSuperAdmin||U("/")}),[D,M,U]);const{data:G,isLoading:R,error:$}=l({queryKey:["/api/admin/analytics",E],queryFn:async()=>{try{const e=await C("GET",`/api/admin/analytics?timeRange=${E}`);if(!e.ok)throw new Error(`Failed to fetch analytics data: ${e.status} ${e.statusText}`);return await e.json()}catch(e){throw e}},enabled:!!(null==D?void 0:D.isSuperAdmin),retry:2});return M?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(n,{className:"h-8 w-8 animate-spin text-primary"})}):(null==D?void 0:D.isSuperAdmin)?i.jsx(r,{children:i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h1",{className:"text-2xl",children:"Analytics Dashboard"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-muted-foreground",children:"Time Range:"}),i.jsxs(c,{value:E,onValueChange:F,children:[i.jsx(d,{className:"w-[180px]",children:i.jsx(x,{placeholder:"Select time range"})}),i.jsxs(o,{children:[i.jsx(m,{value:"7days",children:"Last 7 Days"}),i.jsx(m,{value:"30days",children:"Last 30 Days"}),i.jsx(m,{value:"90days",children:"Last 90 Days"}),i.jsx(m,{value:"year",children:"Last Year"}),i.jsx(m,{value:"all",children:"All Time"})]})]})]})]}),R?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(n,{className:"h-8 w-8 animate-spin text-primary"})}):$?i.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[i.jsx("div",{className:"text-red-500 mb-4",children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10"}),i.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),i.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),i.jsx("h3",{className:"text-xl font-bold mb-2",children:"Error Loading Analytics"}),i.jsx("p",{className:"text-gray-600 mb-4 text-center max-w-md",children:$ instanceof Error?$.message:"Failed to load analytics data"}),i.jsx(h,{onClick:()=>window.location.reload(),children:"Retry"})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[i.jsxs(j,{children:[i.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(f,{className:"text-sm font-medium",children:"Total Users"}),i.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(y,{children:[i.jsx("div",{className:"text-2xl",children:(null==G?void 0:G.totalUsers)||0}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",(null==(A=null==(e=null==G?void 0:G.userGrowth)?void 0:e[G.userGrowth.length-1])?void 0:A.count)||0," in the last period"]})]})]}),i.jsxs(j,{children:[i.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(f,{className:"text-sm font-medium",children:"Companies"}),i.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(y,{children:[i.jsx("div",{className:"text-2xl",children:(null==G?void 0:G.totalCompanies)||0}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[(null==G?void 0:G.activeCompanies)||0," active companies"]})]})]}),i.jsxs(j,{children:[i.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(f,{className:"text-sm font-medium",children:"Messages"}),i.jsx(N,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(y,{children:[i.jsx("div",{className:"text-2xl",children:(null==(S=null==G?void 0:G.totalMessages)?void 0:S.toLocaleString())||0}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:["Across ",(null==G?void 0:G.totalConversations)||0," conversations"]})]})]}),i.jsxs(j,{children:[i.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(f,{className:"text-sm font-medium",children:"Contacts"}),i.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(y,{children:[i.jsx("div",{className:"text-2xl",children:(null==(z=null==G?void 0:G.totalContacts)?void 0:z.toLocaleString())||0}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"In contact database"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs(j,{children:[i.jsxs(u,{children:[i.jsx(f,{children:"User Growth"}),i.jsx(w,{children:"New user registrations over time"})]}),i.jsx(y,{className:"h-80",children:i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx(L,{className:"h-16 w-16 text-muted-foreground"}),i.jsx("p",{className:"ml-4 text-muted-foreground",children:"User growth chart visualization"})]})})]}),i.jsxs(j,{children:[i.jsxs(u,{children:[i.jsx(f,{children:"Messages by Channel"}),i.jsx(w,{children:"Distribution of messages across channels"})]}),i.jsx(y,{className:"h-80",children:i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx(k,{className:"h-16 w-16 text-muted-foreground"}),i.jsx("p",{className:"ml-4 text-muted-foreground",children:"Channel distribution chart visualization"})]})})]}),i.jsxs(j,{children:[i.jsxs(u,{children:[i.jsx(f,{children:"Conversations by Company"}),i.jsx(w,{children:"Top companies by conversation volume"})]}),i.jsx(y,{className:"h-80",children:i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx(b,{className:"h-16 w-16 text-muted-foreground"}),i.jsx("p",{className:"ml-4 text-muted-foreground",children:"Company conversation chart visualization"})]})})]}),i.jsxs(j,{children:[i.jsxs(u,{children:[i.jsx(f,{children:"Active Users"}),i.jsx(w,{children:"Daily active users over time"})]}),i.jsx(y,{className:"h-80",children:i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx(L,{className:"h-16 w-16 text-muted-foreground"}),i.jsx("p",{className:"ml-4 text-muted-foreground",children:"Active users chart visualization"})]})})]})]})]})]})}):null}export{A as default};
