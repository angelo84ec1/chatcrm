import{u as e,f as s,r as i,h as r,j as n,L as a,K as l,B as t,U as u,C as o,a as m,b as c,l as d,c as p,N as h,I as N,ab as x,ac as D,ad as w,ae as v,af as C,ag as b,ah as P,O as f,Q as g,V as j,W as E,X as k,Y as U,H as O,d as V}from"./index-CExeSDUv.js";function M(){const{user:M,isLoading:y}=e(),{toast:L}=s(),[S,A]=i.useState(""),[F,q]=i.useState(null);i.useEffect((()=>{y||!M||M.isSuperAdmin||(window.location.href="/")}),[M,y]);const{data:T,isLoading:K}=r({queryKey:["/api/admin/users"],queryFn:async()=>{const e=await V("GET","/api/admin/users");if(!e.ok)throw new Error("Failed to fetch users");return e.json()},enabled:!!(null==M?void 0:M.isSuperAdmin)}),{data:R}=r({queryKey:["/api/admin/companies"],queryFn:async()=>{const e=await V("GET","/api/admin/companies");if(!e.ok)throw new Error("Failed to fetch companies");return e.json()},enabled:!!(null==M?void 0:M.isSuperAdmin)}),$=null==T?void 0:T.filter((e=>{const s=e.fullName.toLowerCase().includes(S.toLowerCase())||e.username.toLowerCase().includes(S.toLowerCase())||e.email.toLowerCase().includes(S.toLowerCase())||e.role.toLowerCase().includes(S.toLowerCase()),i=null===F||e.companyId===F;return s&&i}));return y?n.jsxDEV("div",{className:"flex items-center justify-center min-h-screen",children:n.jsxDEV(a,{className:"h-8 w-8 animate-spin text-primary"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:117,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:116,columnNumber:7},this):(null==M?void 0:M.isSuperAdmin)?n.jsxDEV(l,{children:n.jsxDEV("div",{className:"p-6",children:[n.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[n.jsxDEV("h1",{className:"text-2xl",children:"Users"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:130,columnNumber:11},this),n.jsxDEV(t,{onClick:()=>window.location.href="/admin/users/new",variant:"brand",className:"btn-brand-primary",children:[n.jsxDEV(u,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:136,columnNumber:13},this),"New User"]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:131,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:129,columnNumber:9},this),n.jsxDEV(o,{className:"mb-6",children:[n.jsxDEV(m,{children:[n.jsxDEV(c,{children:"Manage Users"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:143,columnNumber:13},this),n.jsxDEV(d,{children:"View and manage all users in the system"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:144,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:142,columnNumber:11},this),n.jsxDEV(p,{children:[n.jsxDEV("div",{className:"flex items-center gap-4 mb-4",children:[n.jsxDEV("div",{className:"relative flex-1",children:[n.jsxDEV(h,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:151,columnNumber:17},this),n.jsxDEV(N,{placeholder:"Search users...",className:"pl-8",value:S,onChange:e=>A(e.target.value)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:152,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:150,columnNumber:15},this),n.jsxDEV(x,{children:[n.jsxDEV(D,{asChild:!0,children:n.jsxDEV(t,{variant:"outline",className:"gap-2",children:[n.jsxDEV(w,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:163,columnNumber:21},this),null!==F?"Filtered":"Filter"]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:162,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:161,columnNumber:17},this),n.jsxDEV(v,{align:"end",className:"w-56",children:[n.jsxDEV(C,{children:"Filter by Company"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:168,columnNumber:19},this),n.jsxDEV(b,{},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:169,columnNumber:19},this),n.jsxDEV(P,{onClick:()=>q(null),children:"All Companies"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:170,columnNumber:19},this),null==R?void 0:R.map((e=>n.jsxDEV(P,{onClick:()=>q(e.id),children:e.name},e.id,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:174,columnNumber:21},this)))]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:167,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:160,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:149,columnNumber:13},this),K?n.jsxDEV("div",{className:"flex justify-center py-8",children:n.jsxDEV(a,{className:"h-8 w-8 animate-spin text-primary"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:187,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:186,columnNumber:15},this):0===(null==$?void 0:$.length)?n.jsxDEV("div",{className:"text-center py-8 text-muted-foreground",children:S||null!==F?"No users match your search":"No users found."},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:190,columnNumber:15},this):n.jsxDEV("div",{className:"rounded-md border",children:n.jsxDEV(f,{children:[n.jsxDEV(g,{children:n.jsxDEV(j,{children:[n.jsxDEV(E,{children:"Name"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:198,columnNumber:23},this),n.jsxDEV(E,{children:"Email"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:199,columnNumber:23},this),n.jsxDEV(E,{children:"Role"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:200,columnNumber:23},this),n.jsxDEV(E,{children:"Company"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:201,columnNumber:23},this),n.jsxDEV(E,{children:"Actions"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:202,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:197,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:196,columnNumber:19},this),n.jsxDEV(k,{children:null==$?void 0:$.map((e=>n.jsxDEV(j,{children:[n.jsxDEV(U,{className:"font-medium",children:e.fullName},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:208,columnNumber:25},this),n.jsxDEV(U,{children:e.email},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:209,columnNumber:25},this),n.jsxDEV(U,{children:e.isSuperAdmin?n.jsxDEV(O,{className:"bg-purple-100 text-purple-800 hover:bg-purple-100",children:"Super Admin"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:212,columnNumber:29},this):n.jsxDEV(O,{variant:"outline",className:"capitalize",children:e.role},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:216,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:210,columnNumber:25},this),n.jsxDEV(U,{children:e.companyName||"System"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:221,columnNumber:25},this),n.jsxDEV(U,{children:n.jsxDEV(x,{children:[n.jsxDEV(D,{asChild:!0,children:n.jsxDEV(t,{variant:"ghost",size:"sm",className:"btn-brand-primary",children:"Actions"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:225,columnNumber:31},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:224,columnNumber:29},this),n.jsxDEV(v,{align:"end",children:[n.jsxDEV(P,{onClick:()=>window.location.href=`/admin/users/${e.id}`,children:"Edit User"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:230,columnNumber:31},this),n.jsxDEV(P,{onClick:()=>(async e=>{try{const s=await V("POST",`/api/admin/users/${e}/reset-password`,{});if(!s.ok){const e=await s.json();throw new Error(e.message||"Failed to reset password")}const i=await s.json();L({title:"Password Reset",description:`Temporary password: ${i.temporaryPassword}`})}catch(s){L({title:"Error",description:s.message||"Failed to reset password",variant:"destructive"})}})(e.id),children:"Reset Password"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:235,columnNumber:31},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:229,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:223,columnNumber:27},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:222,columnNumber:25},this)]},e.id,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:207,columnNumber:23},this)))},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:205,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:195,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:194,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:148,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:141,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:128,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/index.tsx",lineNumber:127,columnNumber:5},this):null}export{M as default};
