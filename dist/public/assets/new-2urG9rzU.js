import{u as e,f as s,r,h as n,ai as a,i,j as l,L as t,K as u,B as o,aj as m,C as c,a as p,b as h,l as d,c as w,ak as N,al as D,am as v,an as b,ao as x,I as C,ap as P,aq as f,ar as g,as as E,at as U,au as j,av as k,aw as V,ax as O,ay as M,s as y,d as S,az as A,aA as F,aB as I,aC as q,aD as T}from"./index-CExeSDUv.js";const B=A({username:T().email("Username must be a valid email address"),email:T().email("Email must be a valid email address"),fullName:T().min(2,"Full name must be at least 2 characters"),password:T().min(6,"Password must be at least 6 characters"),confirmPassword:T(),role:q(["admin","agent","user"]),companyId:I().optional(),isSuperAdmin:F().default(!1)}).refine((e=>e.password===e.confirmPassword),{message:"Passwords don't match",path:["confirmPassword"]});function K(){const{user:A,isLoading:F}=e(),{toast:I}=s();r.useEffect((()=>{F||!A||A.isSuperAdmin||(window.location.href="/")}),[A,F]);const{data:q,isLoading:T}=n({queryKey:["/api/admin/companies"],queryFn:async()=>{const e=await S("GET","/api/admin/companies");if(!e.ok)throw new Error("Failed to fetch companies");return e.json()},enabled:!!(null==A?void 0:A.isSuperAdmin)}),K=(null==q?void 0:q.filter((e=>e.active)))||[],L=a({resolver:M(B),defaultValues:{username:"",email:"",fullName:"",password:"",confirmPassword:"",role:"agent",isSuperAdmin:!1}}),z=i({mutationFn:async e=>{const{confirmPassword:s,...r}=e,n=await S("POST","/api/admin/users",r);if(!n.ok){const e=await n.json();throw new Error(e.message||"Failed to create user")}return n.json()},onSuccess:()=>{y.invalidateQueries({queryKey:["/api/admin/users"]}),I({title:"User Created",description:"The user has been created successfully"}),setTimeout((()=>{window.location.href="/admin/users"}),1500)},onError:e=>{I({title:"Error",description:e.message||"Failed to create user",variant:"destructive"})}});return F?l.jsxDEV("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxDEV(t,{className:"h-8 w-8 animate-spin text-primary"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:129,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:128,columnNumber:7},this):(null==A?void 0:A.isSuperAdmin)?l.jsxDEV(u,{children:l.jsxDEV("div",{className:"p-6",children:[l.jsxDEV("div",{className:"flex items-center mb-6",children:[l.jsxDEV(o,{variant:"ghost",size:"sm",onClick:()=>window.location.href="/admin/users",className:"mr-4",children:[l.jsxDEV(m,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:148,columnNumber:13},this),"Back to Users"]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:142,columnNumber:11},this),l.jsxDEV("h1",{className:"text-2xl",children:"Create New User"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:151,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:141,columnNumber:9},this),l.jsxDEV(c,{className:"max-w-2xl mx-auto",children:[l.jsxDEV(p,{children:[l.jsxDEV(h,{children:"User Information"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:156,columnNumber:13},this),l.jsxDEV(d,{children:"Create a new user account in the system"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:157,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:155,columnNumber:11},this),l.jsxDEV(w,{children:l.jsxDEV(N,{...L,children:l.jsxDEV("form",{onSubmit:L.handleSubmit((e=>{z.mutate(e)})),className:"space-y-6",children:[l.jsxDEV(D,{control:L.control,name:"fullName",render:({field:e})=>l.jsxDEV(v,{children:[l.jsxDEV(b,{children:"Full Name"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:169,columnNumber:23},this),l.jsxDEV(x,{children:l.jsxDEV(C,{placeholder:"John Doe",...e},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:171,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:170,columnNumber:23},this),l.jsxDEV(P,{},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:173,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:168,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:164,columnNumber:17},this),l.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxDEV(D,{control:L.control,name:"username",render:({field:e})=>l.jsxDEV(v,{children:[l.jsxDEV(b,{children:"Username (Email)"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:184,columnNumber:25},this),l.jsxDEV(x,{children:l.jsxDEV(C,{placeholder:"user@example.com",...e},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:186,columnNumber:27},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:185,columnNumber:25},this),l.jsxDEV(P,{},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:188,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:183,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:179,columnNumber:19},this),l.jsxDEV(D,{control:L.control,name:"email",render:({field:e})=>l.jsxDEV(v,{children:[l.jsxDEV(b,{children:"Email"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:198,columnNumber:25},this),l.jsxDEV(x,{children:l.jsxDEV(C,{placeholder:"user@example.com",...e},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:200,columnNumber:27},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:199,columnNumber:25},this),l.jsxDEV(P,{},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:202,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:197,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:193,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:178,columnNumber:17},this),l.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxDEV(D,{control:L.control,name:"password",render:({field:e})=>l.jsxDEV(v,{children:[l.jsxDEV(b,{children:"Password"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:214,columnNumber:25},this),l.jsxDEV(x,{children:l.jsxDEV(C,{type:"password",placeholder:"••••••••",...e},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:216,columnNumber:27},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:215,columnNumber:25},this),l.jsxDEV(P,{},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:218,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:213,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:209,columnNumber:19},this),l.jsxDEV(D,{control:L.control,name:"confirmPassword",render:({field:e})=>l.jsxDEV(v,{children:[l.jsxDEV(b,{children:"Confirm Password"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:228,columnNumber:25},this),l.jsxDEV(x,{children:l.jsxDEV(C,{type:"password",placeholder:"••••••••",...e},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:230,columnNumber:27},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:229,columnNumber:25},this),l.jsxDEV(P,{},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:232,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:227,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:223,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:208,columnNumber:17},this),l.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxDEV(D,{control:L.control,name:"role",render:({field:e})=>l.jsxDEV(v,{children:[l.jsxDEV(b,{children:"Role"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:244,columnNumber:25},this),l.jsxDEV(f,{onValueChange:e.onChange,defaultValue:e.value,children:[l.jsxDEV(x,{children:l.jsxDEV(g,{children:l.jsxDEV(E,{placeholder:"Select a role"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:251,columnNumber:31},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:250,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:249,columnNumber:27},this),l.jsxDEV(U,{children:[l.jsxDEV(j,{value:"admin",children:"Admin"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:255,columnNumber:29},this),l.jsxDEV(j,{value:"agent",children:"Agent"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:256,columnNumber:29},this),l.jsxDEV(j,{value:"user",children:"User"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:257,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:254,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:245,columnNumber:25},this),l.jsxDEV(P,{},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:260,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:243,columnNumber:23},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:239,columnNumber:19},this),l.jsxDEV(v,{children:[l.jsxDEV(b,{children:"Company"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:266,columnNumber:21},this),l.jsxDEV(f,{onValueChange:e=>{L.setValue("companyId",parseInt(e))},disabled:T||L.watch("isSuperAdmin"),children:[l.jsxDEV(x,{children:l.jsxDEV(g,{children:l.jsxDEV(E,{placeholder:"Select a company"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:273,columnNumber:27},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:272,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:271,columnNumber:23},this),l.jsxDEV(U,{children:K.map((e=>l.jsxDEV(j,{value:e.id.toString(),children:e.name},e.id,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:278,columnNumber:27},this)))},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:276,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:267,columnNumber:21},this),l.jsxDEV(P,{},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:284,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:265,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:238,columnNumber:17},this),l.jsxDEV(D,{control:L.control,name:"isSuperAdmin",render:({field:e})=>l.jsxDEV(v,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[l.jsxDEV("div",{className:"space-y-0.5",children:[l.jsxDEV(b,{className:"text-base",children:"Super Admin"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:294,columnNumber:25},this),l.jsxDEV(k,{children:"Super admins have access to all system features and settings"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:295,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:293,columnNumber:23},this),l.jsxDEV(x,{children:l.jsxDEV(V,{checked:e.value,onCheckedChange:s=>{e.onChange(s),s&&L.setValue("companyId",void 0)}},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:300,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:299,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:292,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:288,columnNumber:17},this),l.jsxDEV(o,{type:"submit",className:"w-full",disabled:z.isPending,children:z.isPending?l.jsxDEV(l.Fragment,{children:[l.jsxDEV(t,{className:"mr-2 h-4 w-4 animate-spin"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:321,columnNumber:23},this),"Creating User..."]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:320,columnNumber:21},this):l.jsxDEV(l.Fragment,{children:[l.jsxDEV(O,{className:"mr-2 h-4 w-4"},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:326,columnNumber:23},this),"Create User"]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:325,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:314,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:163,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:162,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:161,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:154,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:140,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/Mnsas/OneDrive/Desktop/PowerChatPlus/powerchatplus/client/src/pages/admin/users/new.tsx",lineNumber:139,columnNumber:5},this):null}export{K as default};
