import{e,f as s,r as a,i as t,j as i,C as n,a as r,b as c,l as o,c as l,L as u,o as d,k as m,aL as x,B as f,d as y}from"./index-Cy_6krSr.js";function p(){const[p,j]=e(),{toast:h}=s(),[b,v]=a.useState(!0),[w,g]=a.useState(!1),N=new URLSearchParams(window.location.search),S=N.get("source"),P=N.get("transaction_id"),k=N.get("session_id"),F=t({mutationFn:async()=>{if(!P)return null;const e=await y("POST","/api/payment/verify",{transactionId:P,source:S||"stripe",session_id:k});if(!e.ok){const s=await e.json();throw new Error(s.error||"Failed to verify payment")}return e.json()},onSuccess:e=>{g(!0),v(!1),h({title:"Payment Successful",description:"Your subscription has been activated successfully."})},onError:e=>{g(!1),v(!1),h({title:"Payment Verification Failed",description:e.message,variant:"destructive"})}});return a.useEffect((()=>{P?F.mutate():v(!1)}),[P]),i.jsx("div",{className:"container max-w-md py-12",children:i.jsxs(n,{children:[i.jsxs(r,{className:"text-center",children:[i.jsxs(c,{className:"text-2xl",children:["Payment ",b?"Processing":w?"Successful":"Verification Failed"]}),i.jsx(o,{children:b?"We're verifying your payment...":w?"Your subscription has been activated successfully.":"We couldn't verify your payment. Please contact support."})]}),i.jsx(l,{className:"flex justify-center py-6",children:b?i.jsx(u,{className:"h-16 w-16 animate-spin text-primary"}):w?i.jsx(d,{className:"h-16 w-16 text-green-500"}):i.jsx(m,{className:"h-16 w-16 text-red-500"})}),i.jsxs(x,{className:"flex justify-center gap-4",children:[i.jsx(f,{variant:"outline",onClick:()=>j("/settings"),disabled:b,children:"Return to Settings"}),i.jsx(f,{variant:"outline",className:"btn-brand-primary",onClick:()=>j("/inbox"),disabled:b,children:"Go to inbox"})]})]})})}export{p as default};
